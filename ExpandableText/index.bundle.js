var{default:i,createOrRetrieveShadowRoot:u,setComponentStyleFor:p}=await import("https://kooiinc.github.io/es-webcomponent-factory/Bundle/es-webcomponent-bundle.js").then(e=>e);function c(e,t={},o={}){let n=Object.assign(document.createElement(e),t);if(o=h({trial:r=>Object.entries(o),whenError:r=>[]}),o.length)for(let[r,a]of o)n.dataset[r]=a;return n}function h({trial:e,whenError:t=o=>console.log(o)}={}){try{if(e?.constructor!==Function)throw new TypeError("maybe: trial parameter not a Function or Lambda");return e()}catch(o){return t?.constructor===Function?t(o):console.error(o)}}function f(e,t,o){let n=t.querySelector("style"),r=o.dataset?.externalCssId;if(!(!n&&!r)&&(r&&e.append(document.querySelector(`#${r}`).cloneNode(!0)),n)){let a=new CSSStyleSheet;a.replaceSync(n.innerHTML),n.remove(),e.adoptedStyleSheets.push(a)}}var m=await I();i({componentName:"expandable-text",onConnect:y});function y(e){let t=e.content??A(e);return t?S(e,t):b(e)}function S(e,t){e.content=t;let o=u(e);o.adoptedStyleSheets=[p(e,m)],f(o,t,e),g(e,t,o),o.addEventListener("click",C),R(o)}function g(e,t,o){let n=E(t,e),r=c("div",{className:"expand-title"},{expanded:0}),a=c("div",{className:"title",textContent:n,title:`${n}`});r.append(a),r.prepend(c("div",{className:"arrow"}));let s=c("div",{className:"expand-content"});e.dataset.preview&&s.classList.add("preview"),s.append(t),o.append(r,s)}function b(e){return e?.remove(),console.info("\u2714 an empty <expandable-text> element was removed")}function l(e,t=!1,o=!1){let n=e.querySelector("[data-expanded]"),r=+n.dataset.expanded;if(e.querySelector(".expand-content").scrollTop=0,n.dataset.expanded=+!r,t){let a=e.host.getRootNode().host.shadowRoot.querySelector(".expand-content");return x(a,e)}!o&&w(e)}function w(e){let t=e.host.getRootNode().host?.shadowRoot;if(!t)return;let o=t.querySelector(".expand-content");if(o){let n=o.offsetHeight+o.scrollTop,r=e.host.offsetTop>n-30;setTimeout(a=>r&&o.scroll({top:o.scrollTop+150,behavior:"smooth"}),150)}}function C(e){let t=e.target.getRootNode(),o=e.target.closest(".expand-content.preview")?.getRootNode().querySelector("[data-expanded]").dataset.expanded==="0",n=!e.target.closest(".expand-content"),r=!!t.querySelector("[data-expanded='0']"),a=n||o||r,s=!!e.target.closest("[data-collapse-all]"),d=!!e.target.closest("[data-expand-all]");switch(!0){case a:return l(t);case s:return T(t);case d:return q(t);default:return}}function R(e){let t=e.host.getRootNode().host;t&&[...t.shadowRoot.querySelectorAll("expandable-text")].filter(n=>n?.shadowRoot?.querySelector("[data-open-from-id]")).forEach(n=>n.shadowRoot.addEventListener("click",o));function o(n){let r=n.target.getRootNode(),a=n.target.closest("[data-open-from-id]");if(a){let s=r.host.getRootNode().querySelector(`#${a.dataset.openFromId}`)?.shadowRoot,d=r.host.getRootNode().host.shadowRoot.querySelector(".expand-content");if(s)return n.stopImmediatePropagation(),s.querySelector("[data-expanded='0']")&&l(s,!0)||x(d,s)}return!1}}function x(e,t){setTimeout(o=>e&&t&&e.scroll({top:t.host.offsetTop-40,behavior:"smooth"}),150)}function T(e){[...e.querySelectorAll("expandable-text")].filter(t=>t.shadowRoot?.querySelector(".expand-title").dataset.expanded==="1").forEach(t=>l(t.shadowRoot,!1,!0))}function q(e){[...e.querySelectorAll("expandable-text")].filter(t=>t.shadowRoot?.querySelector(".expand-title").dataset.expanded==="0").forEach(t=>l(t.shadowRoot,!1,!0))}function E(e,t){let o=e.querySelector(".expand-ttl"),n=(o?.textContent??t.dataset?.title?.trim()?.replace(/\s{2,}/g," ").replace(/\n/g,"")??"").trim();return o?.remove(),n.length>0?n:"--NO TITLE--"}function A(e){let t=e.querySelector("template")?.cloneNode(!0),o=document.querySelector(`#${e.dataset?.contentId}`),n=e.innerHTML.trim();return e.textContent="",t?t.content:n.length>0?c("div",{innerHTML:n}):o?.content}async function I(){let e=import.meta.resolve("./").replace("index.js","");return await fetch(`${e}ExpandableText.css`).then(t=>t.text())}
