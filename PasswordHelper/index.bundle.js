import re from"https://cdn.jsdelivr.net/gh/KooiInc/StringInterpolator@latest/Interpolate.module.min.js";var{default:g,createOrRetrieveShadowRoot:S,setComponentStyleFor:k}=await import("https://kooiinc.github.io/es-webcomponent-factory/Bundle/es-webcomponent-bundle.js").then(e=>e);function l(e,t={},n={}){let o=Object.assign(document.createElement(e),t);if(n=$({trial:r=>Object.entries(n),whenError:r=>[]}),n.length)for(let[r,i]of n)o.dataset[r]=i;return o}function $({trial:e,whenError:t=n=>console.log(n)}={}){try{if(e?.constructor!==Function)throw new TypeError("maybe: trial parameter not a Function or Lambda");return e()}catch(n){return t?.constructor===Function?t(n):console.error(n)}}var{default:M,createOrRetrieveShadowRoot:B,setComponentStyleFor:O}=await import("https://kooiinc.github.io/es-webcomponent-factory/Bundle/es-webcomponent-bundle.js").then(e=>e);function f(e,t={},n={}){let o=Object.assign(document.createElement(e),t);if(n=F({trial:r=>Object.entries(n),whenError:r=>[]}),n.length)for(let[r,i]of n)o.dataset[r]=i;return o}function F({trial:e,whenError:t=n=>console.log(n)}={}){try{if(e?.constructor!==Function)throw new TypeError("maybe: trial parameter not a Function or Lambda");return e()}catch(n){return t?.constructor===Function?t(n):console.error(n)}}function G(e,t,n){let o=t.querySelector("style"),r=n.dataset?.externalCssId;if(!(!o&&!r)&&(r&&e.append(document.querySelector(`#${r}`).cloneNode(!0)),o)){let i=new CSSStyleSheet;i.replaceSync(o.innerHTML),o.remove(),e.adoptedStyleSheets.push(i)}}var j=await Z();M({componentName:"expandable-text",onConnect:P});function P(e){let t=e.content??X(e);return t?_(e,t):D(e)}function _(e,t){e.content=t;let n=B(e);n.adoptedStyleSheets=[O(e,j)],G(n,t,e),z(e,t,n),n.addEventListener("click",W),U(n)}function z(e,t,n){let o=K(t,e),r=f("div",{className:"expand-title"},{expanded:0}),i=f("div",{className:"title",textContent:o,title:`${o}`});r.append(i),r.prepend(f("div",{className:"arrow"}));let s=f("div",{className:"expand-content"});e.dataset.preview&&s.classList.add("preview"),s.append(t),n.append(r,s)}function D(e){return e?.remove(),console.info("\u2714 an empty <expandable-text> element was removed")}function x(e,t=!1,n=!1){let o=e.querySelector("[data-expanded]"),r=+o.dataset.expanded;if(e.querySelector(".expand-content").scrollTop=0,o.dataset.expanded=+!r,t){let i=e.host.getRootNode().host.shadowRoot.querySelector(".expand-content");return v(i,e)}!n&&H(e)}function H(e){let t=e.host.getRootNode().host?.shadowRoot;if(!t)return;let n=t.querySelector(".expand-content");if(n){let o=n.offsetHeight+n.scrollTop,r=e.host.offsetTop>o-30;setTimeout(i=>r&&n.scroll({top:n.scrollTop+150,behavior:"smooth"}),150)}}function W(e){let t=e.target.getRootNode(),n=e.target.closest(".expand-content.preview")?.getRootNode().querySelector("[data-expanded]").dataset.expanded==="0",o=!e.target.closest(".expand-content"),r=!!t.querySelector("[data-expanded='0']"),i=o||n||r,s=!!e.target.closest("[data-collapse-all]"),u=!!e.target.closest("[data-expand-all]");switch(!0){case i:return x(t);case s:return V(t);case u:return Y(t);default:return}}function U(e){let t=e.host.getRootNode().host;t&&[...t.shadowRoot.querySelectorAll("expandable-text")].filter(o=>o?.shadowRoot?.querySelector("[data-open-from-id]")).forEach(o=>o.shadowRoot.addEventListener("click",n));function n(o){let r=o.target.getRootNode(),i=o.target.closest("[data-open-from-id]");if(i){let s=r.host.getRootNode().querySelector(`#${i.dataset.openFromId}`)?.shadowRoot,u=r.host.getRootNode().host.shadowRoot.querySelector(".expand-content");if(s)return o.stopImmediatePropagation(),s.querySelector("[data-expanded='0']")&&x(s,!0)||v(u,s)}return!1}}function v(e,t){setTimeout(n=>e&&t&&e.scroll({top:t.host.offsetTop-40,behavior:"smooth"}),150)}function V(e){[...e.querySelectorAll("expandable-text")].filter(t=>t.shadowRoot?.querySelector(".expand-title").dataset.expanded==="1").forEach(t=>x(t.shadowRoot,!1,!0))}function Y(e){[...e.querySelectorAll("expandable-text")].filter(t=>t.shadowRoot?.querySelector(".expand-title").dataset.expanded==="0").forEach(t=>x(t.shadowRoot,!1,!0))}function K(e,t){let n=e.querySelector(".expand-ttl"),o=(n?.textContent??t.dataset?.title?.trim()?.replace(/\s{2,}/g," ").replace(/\n/g,"")??"").trim();return n?.remove(),o.length>0?o:"--NO TITLE--"}function X(e){let t=e.querySelector("template")?.cloneNode(!0),n=document.querySelector(`#${e.dataset?.contentId}`),o=e.innerHTML.trim();return e.textContent="",t?t.content:o.length>0?f("div",{innerHTML:o}):n?.content}async function Z(){return Promise.resolve(`:host{display:block;position:relative;.expand-ttl{display:none;} .expand-title{display:block;user-select:none;font-weight:bold;cursor:pointer;position:relative;.title{display:inline-block;font-family:system-ui,"Sans Serif";font-size:1.2rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:90%;height:auto;line-height:normal;} .arrow{display:inline-block;margin:auto;color:#a15a57;font-size:1.3em;text-align:center;vertical-align:super;&:before{font-size:1.3rem;margin-right:5px;text-shadow:-1px 1px 2px #999;content:'\u2198';transition:all 1s ease;display:inline-block;} } &[data-expanded='1'] .title{color:#506988;} &[data-expanded='1'] .arrow:before{transform:rotateX(3.14rad);vertical-align:text-bottom;} &[data-expanded='0'] + .expand-content{overflow:hidden;max-height:0;padding:0;opacity:0;margin:0;transition:all 1s ease;} &[data-expanded='0'] + .expand-content.preview{max-height:80px;opacity:1;mask-image:linear-gradient(#000,transparent);cursor:pointer;} &[data-expanded='1'] + .expand-content{max-height:50vh;max-width:100%;overflow-y:auto;transition:all 1s ease;border:1px dashed #ccc;padding:12px;margin:auto auto 0.7em auto;cursor:default;[data-open-from-id],[data-collapse-all],[data-expand-all]{color:#557492;font-weight:500;cursor:pointer;} } } @media (hover:hover) and (pointer:fine){.expand-title .title:hover{color:#506988;} [data-open-from-id]:hover,[data-collapse-all]:hover,[data-expand-all]:hover{text-decoration:underline;} .expand-title .arrow:hover:after,.expand-title .title:hover:before{color:#000;font-weight:normal;font-size:10pt;line-height:1rem;background-color:white;position:absolute;margin:0.2em auto auto -0.2em;border:1px solid #AAA;padding:3px;z-index:10;opacity:0.9;box-shadow:1px 1px 5px #999;white-space:nowrap;} .expand-title[data-expanded='0'] .arrow:hover:after,.expand-title[data-expanded='0'] .title:hover:before{content:'click to expand';} .expand-title[data-expanded='1'] .arrow:hover:after,.expand-title[data-expanded='1'] .title:hover:before{content:'click to collapse';} }}`)}var y={NL:"heel zwak,zwak,goed,prima,uitstekend".split(","),EN:"very weak,weak,ok,fine,excellent".split(",")};function C(){return function(e,t=h.defaultSettings){e=ee(e),h.Sym=t.Sym?t.Symbols:h.Sym,delete t.Symbols;let n=J(t),o=n.length-1,r=[...Array(e)].map(s=>n[m(o)]),i=Q(r,t);return r.length!==e||i.length!==e&&console.log("godgloeiondo en WTF",`
[${r.join("")}]
[${i}]`),i}}var E=e=>String.fromCharCode(e),h={UC:N({start:65,len:26,remap:E}),LC:N({start:97,len:26,remap:E}),Nrs:N(),SymDefault:["!","?","@","#","$","%","^","&","*","=","+","_",";","-"],Sym:[],defaultSettings:{UC:!0,Nrs:!1,Sym:!1,AFrst:!1}};function J(e){let t=Object.entries(e).reduce((n,[o,r])=>e[o]&&h[o]?[...n,...h[o]]:n,[]).flat();return T(t.concat(h.LC))}function Q(e,t){let n=h.Sym;return t.AFrst&&!/[a-z]/i.test(e[0])&&(e[0]=te(!0)),t.Nrs&&!e.find(o=>!isNaN(parseInt(o)))&&(e[1]=m(9)),t.Sym&&n.length&&!e.find(o=>n.findIndex(r=>o===r)>-1)&&(e[1]=n[m(n.length-1)||0]),e=[e[0],...T(e.slice(1))],e[0]===" "&&(e=L(e,!0)),e[e.length-1]===" "&&(e=L(e)),e.join("")}function L(e,t){let n=e.length-1;return e=t?e.slice(1):e.slice(0,-1),e.splice(m(n-1,1),0," "),e}function ee(e){return e=parseInt(e),isNaN(e)||e<8?8:e}function te(e){let t=h.LC.concat(e?h.UC:[]);return t[m(t.length-1)]}function T(e){let t=e.length,n=t-1;for(;t--;){let o=m(n);[e[t],e[o]]=[e[o],e[t]]}return e}function m(e,t=0){return[e,t]=[Math.floor(e),Math.ceil(t)],Math.floor([...crypto.getRandomValues(new Uint32Array(1))].shift()/2**32*(e-t+1)+t)}function N({start:e=0,len:t=10,remap:n}={}){return n&&n instanceof Function?[...Array(t)].map((o,r)=>e+r).map(n):[...Array(t)].map((o,r)=>e+r)}function A(e){let t=e.length,n=[...e].reduce((s,u)=>({...s,[u]:(s[u]||0)+1}),{}),o=Object.values(n).reduce((s,u)=>s-u/t*Math.log2(u/t),0)*t,r=o>2?BigInt(2**Math.floor(o)/2):0,i=BigInt(Math.floor(2**Math.floor(o)/2/1e5/86400));return{entropy:o,guessDurationInDays:i,intruderGuessAttempts:r}}function q(e,t="EN"){return e<25?y[t][0]:e<50?y[t][1]:e<70?y[t][2]:e<80?y[t][3]:y[t][4]}var b={buttons:{copy:{EN:"Copy",NL:"Kopieer"},clear:{EN:"Clear",NL:"Maak leeg"}},texts:{cantCopy:{EN:"Copy to clipboard is only possible for a page loaded with http<b>S</b>",NL:"Kopieren naar het klembord kan alleen op een met http<b>S</b> beveiligde pagina"},browserTooOld:{EN:"The browser does not support this. Please update.",NL:"Het internetbladerprogramma is hier te oud voor"},noValue:{EN:"Please supply a password value",NL:"Voer svp een wachtwoord in"},symCBTtl:{EN:"Use selected non-letters (select characters in the 'Include' block)",NL:"Gebruik niet-letters (selecteer tekens in het 'Gebruik'-blokje)"},min8:{EN:"Minimum 8 (enforced)",NL:"Minimum 8 (afgedwongen)"},useNumbers:{EN:"Use numbers",NL:"Gebruik getallen"},symCBText:{EN:"Use non-letters",NL:"Gebruik niet-letters"},useUpperCase:{EN:"Use upper case",NL:"Gebruik hoofdletters"},include:{EN:"Include",NL:"Gebruik"},startWithLetter:{EN:"Start with letter",NL:"Begin met een letter"},all:{EN:"All",NL:"All"},allState:{EN:"All",NL:"Alles"},nonState:{EN:"None",NL:"Niks"},none:{EN:"None",NL:"None"},selectAllNO:{EN:"Select all",NL:"Selecteer alles"},selectAllYES:{EN:"Select none",NL:"Selecteer niks"},allTxt:{EN:"of the above",NL:"hierboven"},createBttnTxt:{EN:"Create",NL:"Maak wachtwoord"},initialSymBttnTxt:{EN:"Initial selection",NL:"Initi\xEBle selectie"},copied:{EN:"Copied!",NL:"Gekopieerd!"},copyFailed:{EN:"Copy failed, sorry for that",NL:"Kopi\xEBren helaas niet gelukt"},placeHolder:{EN:"start typing...",NL:"begin met typen..."},copyTtl:{EN:"copy to clipboard",NL:"kopieer naar klembord"},generatePwd:{EN:"Generate a password",NL:"Maak een wachtwoord"},expand:{EN:"click to expand",NL:"klik om te tonen"},collapse:{EN:"click to collapse",NL:"klik om verbergen"},entropy:{EN:"Shannon entropy (total)",NL:"Shannon entropie (totaal)"},space:{EN:"space",NL:"spatie"}},instruction:{EN:` <div class="p"> Start filling out the input field above or click '<i>Generate a password</i>' to let the application create a 'random' password. </div><div class="p"> The strength of a password needed depends on its use: for a web shop one may need a less strong password (strength: <b>ok</b> to <b>fine</b>) than for online banking (minimal strength <b>fine</b>). </div><div class="p"> Mostly (but not allways) the <i>length</i> of a password is the main factor for its strength. For a strong password it may be wise to use a <i>password <b>line</b></i> that is easy to remember. </div><div><b>Example lines</b> (click a line to check its strength): <ul><li><i>Oh no! I need a password!</i></li><li><i>Passwords are not my forte</i></li><li><i>If only I didn't have to worry about my bank balance</i></li><li><i>Cicero said: the apex of old age is influence.</i></li></ul></div>`,NL:` <div class="p"> Vul het invoerveld hierboven in of klik op '<i>Maak een wachtwoord</i>' om een wachtwoord met onwillekeurige tekens te laten maken. </div><div class="p"> De benodigde sterkte van een wachtwoord is afhankelijk van waar het voor wordt gebruikt: voor een webwinkel is doorgaans een minder sterk wachtwoord (sterkte <b>goed</b> tot <b>prima</b> nodig dan voor een online bankieren (sterkte <b>prima</b> of beter). </div><div class="p"> Veelal (maar niet altijd) is de <i>lengte</i> van een wachtwoord de belangrijkste factor voor de sterkte ervan. Een goed wachtwoord kan prima een hele zin zijn. Dat is veel gemakkelijker te onthouden en een zin van enkele woorden geeft vaak al een heel sterk wachtwoord. </div><div><b>Voorbeelden van wachtwoordzinnen</b> (klik op een zin om de sterkte ervan te testen): <ul><li><i>O help! Ik heb een wachtwoord nodig!</i></li><li><i>Ik kan helemaal niks met wachtwoorden</i></li><li><i>Als ik me nou maar niet steeds zorgen moet maken over mijn banksaldo</i></li><li><i>Cicero zei al: het toppunt van ouderdom is invloed.</i></li></ul></div>`}};b.inWordsLanguage=ne;var a=b,d={thats:{EN:"That's",NL:"Dat is"},what:{EN:"Without a dictionary and at a guess rate of",NL:"Zonder een 'woordenboek' en met een raadfrequentie van"},second:{EN:"second",NL:"seconde"},wouldTake:{EN:"that would take",NL:"zou dat"},years:{EN:"year(s)",NL:"jaar"},days:{EN:"day(s)",NL:"dag(en)"},lessThanADay:{EN:"less than a day",NL:"minder dan een dag"},vergen:{EN:"",NL:"duren"},atLeast:{EN:"A hacker needs to guess <i>at least</i>",NL:"Een hacker heeft <i>tenminste</i>"},times:{EN:"time(s)",NL:"raadpogingen nodig"},and:{EN:"and",NL:"en"}};function ne(e,t,n,o="EN"){let r=t<1&&n<1?`<b><i>${d.lessThanADay[o]}</i></b>`:`${t.toLocaleString(o)} ${d.years[o]} ${d.and[o]} ${n} ${d.days[o]}`;return e.entropy<=2?"":`${d.thats[o]} ${oe(e.intruderGuessAttempts,e.entropy,o)}
      ${d.what[o]} ${1e5.toLocaleString(o)} per ${d.second[o]} ${d.wouldTake[o]} ${r} ${d.vergen[o]}`}function oe(e,t,n){let o=q(t,n);return t>=2?`<b>${o}</b>. ${d.atLeast[n]} ${e.toLocaleString(n)} ${d.times[n].toLocaleString(n)}.`:`<b>${o}</b>`}var R=import.meta.resolve("./").replace("index.js",""),c,ae=await be(),ie=await ge(),se=C(),le=()=>l("a",{target:"_blank",href:"//en.wikipedia.org/wiki/Password_strength#Entropy_as_a_measure_of_password_strength",textContent:a.texts.entropy[c]}),w,p;g({componentName:"password-helper",onConnect:ce});function ce(e){c=e.dataset?.language||"EN";let t=de(c),n=S(e);n.adoptedStyleSheets=[k(e,ie)],n.append(t),w=n.querySelector("#generator").shadowRoot,w.addEventListener("click",pe),p=n,["click","keyup"].forEach(o=>p.addEventListener(o,xe))}function de(e){let t=l("div",{className:"content"}),n=e==="EN",o=n?"NL":"EN",r=n?"Dutch":"English",i=l("div");return i.append(l("input",{id:"pass",type:"text",placeholder:a.texts.placeHolder[e]}),l("button",{id:"copy",textContent:a.buttons.copy[e],title:a.texts.copyTtl[e]}),l("button",{id:"clear",textContent:a.buttons.clear[e]}),l("button",{id:"switchLang",title:r},{language:o}),l("span",{id:"copied"}),l("div",{className:"entropyBox",textContent:" "}),l("p",{className:"instruction",innerHTML:a.instruction[e]})),t.append(i,l("div",{id:"symCharsClone",className:"hidden"})),t.insertAdjacentHTML("beforeend",we(e)),t}function pe(e){let t=e.target,n=t.closest("#generate"),o=t.closest("#AllNone"),r=t.closest("#initialSyms"),i=t.closest("#allSyms"),s=t.closest(".expand-content");switch(!0){case!!o:return me(o,s);case!!n:return fe(s);case!!i:return ue(i,s);case!!r:return he(r,s);default:return!0}}function ue(e,t){let n=e.dataset.all==="YES";return t.querySelectorAll("#symChars input").forEach(o=>o.checked=!n),e.dataset.all=n?"NO":"YES"}function he(e,t){t.querySelectorAll("#symChars input").forEach(n=>n.checked=n.dataset.initial==="1"),t.querySelector("#allSyms").dataset.all="NO"}function me(e,t){let n=e.dataset.state==="All";return e.dataset.state=n?a.texts.none[c]:a.texts.all[c],e.dataset.stateLang=n?a.texts.nonState[c]:a.texts.allState[c],t.querySelectorAll(".cbi [type=checkbox]").forEach(o=>o.checked=n)}function fe(e){let t=p.querySelector("#pass"),n=ye(),o=+e.querySelector("[type=number]").value||8,r=se(o,n);t.value=r,I(r),t.scrollIntoView()}function ye(){let e=[...w.querySelectorAll(".genLeft .cbi input")].reduce((n,o)=>({...n,[o.id]:o.checked}),{}),t=[...w.querySelectorAll("#symChars .cb input:checked")].map(n=>n.value);return{...e,Symbols:t}}function I(e){let t=A(e),n=BigInt(t.guessDurationInDays),o=n/365n,r=n%365n,i=p.querySelector(".entropyBox");i.classList.remove("copyReport"),i.textContent="";let s=a.inWordsLanguage(t,o,r,c);i.append(le(),l("b",{textContent:` ${Math.round(t.entropy)} bits`}),l("div",{innerHTML:s}))}function xe(e){let t=p.querySelector("#pass");if(e.target.id==="switchLang")return p.host.replaceWith(l("password-helper",{},{language:e.target.dataset.language}));if(e.target.closest("li"))return t.value=e.target.closest("li").textContent,t.click();if(e.target.id==="clear"){let n=p.querySelector("#pass");return n.value="",p.querySelector("#pass").click(),n.focus()}if(e.target.id==="pass")return e.target.value.length<1?p.querySelector(".entropyBox").textContent="":I(e.target.value);if(e.target.id==="copy")return Ne(e.target.getRootNode())}function we(e="EN"){return re(`${ae}`,{symCBTtl:a.texts.symCBTtl[e],symCBText:a.texts.symCBText[e],min8:a.texts.min8[e],useNumbers:a.texts.useNumbers[e],startWithLetter:a.texts.startWithLetter[e],useUpperCase:a.texts.useUpperCase[e],createBttnTxt:a.texts.createBttnTxt[e],all:a.texts.all[e],allState:a.texts.allState[e],allTxt:a.texts.allTxt[e],initialSymBttnTxt:a.texts.initialSymBttnTxt[e],include:a.texts.include[e],generatePwd:a.texts.generatePwd[e],expand:a.texts.expand[e],collapse:a.texts.collapse[e],selectAllNO:a.texts.selectAllNO[e],selectAllYES:a.texts.selectAllYES[e],space:a.texts.space[e]})}async function Ne(){let e=p.querySelector("#pass"),t=p.querySelector(".entropyBox");if(t.classList.add("copyReport"),location.protocol==="http:")return t.innerHTML=a.texts.cantCopy[c];if(!navigator.clipboard)return t.innerHTM=a.texts.browserTooOld[c];if(e.value.trim()==="")return t.innerHTML=a.texts.noValue[c];if(e){let n="text/plain",o=new Blob([e.value],{type:n});navigator.clipboard.write([new ClipboardItem({[n]:o})]).then(r=>t.textContent=a.texts.copied[c]).catch(r=>t.textContent=a.texts.copyFailed[c])}}async function be(){return await fetch(`${R}GeneratorTemplate.html`).then(e=>e.text())}async function ge(){return await fetch(`${R}PasswordHelper.css`).then(e=>e.text())}
